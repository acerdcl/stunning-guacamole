<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>目标拆解规划师 | 把暴富变成可量化的目标</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <!-- 引入LeanCloud SDK -->
  <script src="https://cdn.jsdelivr.net/npm/leancloud-storage@4.12.0/dist/av-min.js"></script>
  
  <!-- 配置Tailwind自定义颜色和字体 -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#3B82F6',
            secondary: '#10B981',
            accent: '#F59E0B',
            dark: '#1E293B',
            light: '#F8FAFC'
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
          },
        },
      }
    }
  </script>
  
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .text-shadow {
        text-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }
      .card-hover {
        transition: all 0.3s ease;
      }
      .card-hover:hover {
        transform: translateY(-5px);
      }
      .gradient-bg {
        background: linear-gradient(135deg, #3B82F6 0%, #10B981 100%);
      }
      .like-animation {
        animation: like 0.5s ease;
      }
      @keyframes like {
        0% { transform: scale(1); }
        50% { transform: scale(1.3); }
        100% { transform: scale(1); }
      }
      .top-badge {
        position: absolute;
        top: -8px;
        right: -8px;
        width: 24px;
        height: 24px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        font-weight: bold;
        color: white;
      }
    }
  </style>
</head>

<body class="bg-gray-50 font-sans text-dark">
  <!-- 页面头部 -->
  <header class="relative overflow-hidden gradient-bg text-white">
    <div class="absolute inset-0 opacity-10">
      <div class="absolute -top-10 -left-10 w-40 h-40 rounded-full bg-white"></div>
      <div class="absolute top-20 right-10 w-60 h-60 rounded-full bg-white"></div>
      <div class="absolute bottom-10 left-1/3 w-20 h-20 rounded-full bg-white"></div>
    </div>
    
    <div class="container mx-auto px-4 py-16 md:py-24 relative z-10">
      <div class="max-w-3xl mx-auto text-center">
        <h1 class="text-[clamp(2rem,5vw,3.5rem)] font-bold mb-6 leading-tight text-shadow">
          把"暴富"变成<span class="text-accent">可量化的目标</span>
        </h1>
        <p class="text-lg md:text-xl opacity-90 mb-8">
          梦想需要拆解成具体的步骤才能实现。设定明确、可衡量的小目标，
          一步步走向你的"暴富"梦想吧！
        </p>
        <div class="flex justify-center">
          <a href="#form-section" class="bg-white text-primary font-medium px-6 py-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 flex items-center gap-2">
            <i class="fa fa-rocket"></i>
            开始设定目标
          </a>
        </div>
      </div>
    </div>
    
    <div class="absolute bottom-0 left-0 right-0 h-16 bg-gradient-to-t from-gray-50 to-transparent"></div>
  </header>

  <main class="container mx-auto px-4 py-12">
    <!-- 介绍部分 -->
    <section class="max-w-3xl mx-auto mb-16 text-center">
      <h2 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold mb-6 text-dark">
        如何将"暴富"拆解为可量化目标？
      </h2>
      <p class="text-gray-600 mb-8 text-lg">
        比如：不是说"我要学习设计"，而是设定"30天学会PS并做出一张主图点击率过5%"
      </p>
      
      <div class="grid md:grid-cols-3 gap-6 mt-12">
        <div class="bg-white p-6 rounded-xl shadow-md card-hover">
          <div class="w-14 h-14 bg-primary/10 rounded-full flex items-center justify-center mb-4 mx-auto">
            <i class="fa fa-bullseye text-2xl text-primary"></i>
          </div>
          <h3 class="font-bold text-xl mb-2">明确具体</h3>
          <p class="text-gray-600">目标要清晰具体，避免模糊不清的表述</p>
        </div>
        
        <div class="bg-white p-6 rounded-xl shadow-md card-hover">
          <div class="w-14 h-14 bg-secondary/10 rounded-full flex items-center justify-center mb-4 mx-auto">
            <i class="fa fa-calendar-check-o text-2xl text-secondary"></i>
          </div>
          <h3 class="font-bold text-xl mb-2">有时间限制</h3>
          <p class="text-gray-600">设定完成期限，增加目标的执行力</p>
        </div>
        
        <div class="bg-white p-6 rounded-xl shadow-md card-hover">
          <div class="w-14 h-14 bg-accent/10 rounded-full flex items-center justify-center mb-4 mx-auto">
            <i class="fa fa-line-chart text-2xl text-accent"></i>
          </div>
          <h3 class="font-bold text-xl mb-2">可衡量</h3>
          <p class="text-gray-600">设定量化指标，明确知道是否达成</p>
        </div>
      </div>
    </section>
    
    <!-- 表单部分 -->
    <section id="form-section" class="max-w-2xl mx-auto mb-20">
      <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8 transform transition-all duration-300 hover:shadow-2xl">
        <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center">写下你的可量化目标</h2>
        
        <form id="goal-form" class="space-y-6">
          <div>
            <label for="goal" class="block text-gray-700 font-medium mb-2">你的具体目标是？</label>
            <input 
              type="text" 
              id="goal" 
              name="goal" 
              placeholder="例如：30天学会PS并做出一张主图点击率过5%"
              class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-all"
              required
            >
          </div>
          
          <div>
            <label for="deadline" class="block text-gray-700 font-medium mb-2">计划完成时间</label>
            <input 
              type="text" 
              id="deadline" 
              name="deadline" 
              placeholder="例如：2023年12月31日"
              class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-all"
              required
            >
          </div>
          
          <div>
            <label for="measure" class="block text-gray-700 font-medium mb-2">如何衡量是否达成？</label>
            <input 
              type="text" 
              id="measure" 
              name="measure" 
              placeholder="例如：主图点击率达到5%以上"
              class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-all"
              required
            >
          </div>
          
          <button 
            type="submit" 
            class="w-full bg-primary hover:bg-primary/90 text-white font-medium py-3 px-6 rounded-lg transition-all duration-300 transform hover:scale-[1.02] active:scale-[0.98] flex items-center justify-center gap-2"
          >
            <i class="fa fa-paper-plane"></i>
            提交我的目标
          </button>
        </form>
      </div>
    </section>
    
    <!-- 随机目标区域 -->
    <section class="max-w-5xl mx-auto mb-20">
      <div class="flex flex-col md:flex-row justify-between items-center mb-10">
        <h2 class="text-2xl md:text-3xl font-bold">随机精选目标</h2>
        <button 
          id="refresh-btn" 
          class="mt-4 md:mt-0 bg-white border border-primary text-primary hover:bg-primary/5 font-medium py-2 px-5 rounded-lg transition-all duration-300 flex items-center gap-2"
        >
          <i class="fa fa-refresh"></i>
          换一批
        </button>
      </div>
      
      <div id="random-goals-container" class="grid md:grid-cols-3 gap-6">
        <!-- 随机目标卡片将通过JavaScript动态生成 -->
        <div class="flex items-center justify-center h-80 bg-gray-100 rounded-xl border-2 border-dashed border-gray-300">
          <p class="text-gray-500 text-center px-4">加载中...</p>
        </div>
        <div class="flex items-center justify-center h-80 bg-gray-100 rounded-xl border-2 border-dashed border-gray-300">
          <p class="text-gray-500 text-center px-4">加载中...</p>
        </div>
        <div class="flex items-center justify-center h-80 bg-gray-100 rounded-xl border-2 border-dashed border-gray-300">
          <p class="text-gray-500 text-center px-4">加载中...</p>
        </div>
      </div>
    </section>
    
    <!-- 热门目标区域 -->
    <section class="max-w-5xl mx-auto">
      <div class="flex items-center gap-2 mb-10">
        <h2 class="text-2xl md:text-3xl font-bold">最受欢迎的目标</h2>
        <span class="bg-accent/10 text-accent text-sm px-3 py-1 rounded-full">点赞数最高</span>
      </div>
      
      <div id="top-goals-container" class="grid md:grid-cols-3 gap-6">
        <!-- 热门目标卡片将通过JavaScript动态生成 -->
        <div class="flex items-center justify-center h-80 bg-gray-100 rounded-xl border-2 border-dashed border-gray-300">
          <p class="text-gray-500 text-center px-4">加载中...</p>
        </div>
        <div class="flex items-center justify-center h-80 bg-gray-100 rounded-xl border-2 border-dashed border-gray-300">
          <p class="text-gray-500 text-center px-4">加载中...</p>
        </div>
        <div class="flex items-center justify-center h-80 bg-gray-100 rounded-xl border-2 border-dashed border-gray-300">
          <p class="text-gray-500 text-center px-4">加载中...</p>
        </div>
      </div>
    </section>
  </main>
  
  <!-- 页脚 -->
  <footer class="bg-dark text-white py-12 mt-20">
    <div class="container mx-auto px-4 text-center">
      <h3 class="text-xl font-bold mb-4">目标拆解规划师</h3>
      <p class="text-gray-400 max-w-md mx-auto mb-6">
        每天前进一小步，距离"暴富"梦想就更近一步。坚持下去，你会看到改变！
      </p>
      <div class="flex justify-center gap-4 mb-6">
        <a href="#" class="text-gray-400 hover:text-white transition-colors">
          <i class="fa fa-weibo text-xl"></i>
        </a>
        <a href="#" class="text-gray-400 hover:text-white transition-colors">
          <i class="fa fa-wechat text-xl"></i>
        </a>
        <a href="#" class="text-gray-400 hover:text-white transition-colors">
          <i class="fa fa-github text-xl"></i>
        </a>
      </div>
      <p class="text-gray-500 text-sm">目标规划师 - 让梦想照进现实</p>
      <p class="text-gray-500 text-sm">Copyright © 2025 by 电商杜老师</p>
    </div>
  </footer>
  
  <!-- 提示框 -->
  <div id="toast" class="fixed bottom-6 right-6 px-6 py-3 rounded-lg shadow-lg transform translate-y-20 opacity-0 transition-all duration-500 flex items-center gap-3">
    <i id="toast-icon" class="fa fa-check-circle text-xl"></i>
    <span id="toast-message">操作成功！</span>
  </div>

  <script>
    // 初始化LeanCloud
    AV.init({
      appId: "uJ3KsasvmBzf9Xn2OodGclFx-gzGzoHsz",
      appKey: "JEsdiH1q5v1NzqyLCLqJVWvt",
      serverURLs: "https://uj3ksasv.lc-cn-n1-shared.com"
    });
    
    // 获取用户唯一标识
    function getUserId() {
      let userId = localStorage.getItem('flag_planner_user_id');
      if (!userId) {
        // 生成一个随机用户ID并保存
        userId = 'user_' + Math.random().toString(36).substr(2, 9);
        localStorage.setItem('flag_planner_user_id', userId);
      }
      return userId;
    }
    
    // 目标数据操作
    const GoalService = {
      // 保存目标到LeanCloud
      async saveGoal(goal) {
        const Goals = AV.Object.extend('Goals');
        const goalObj = new Goals();
        
        goalObj.set('content', goal.goal);
        goalObj.set('deadline', goal.deadline);
        goalObj.set('measure', goal.measure);
        goalObj.set('userId', getUserId());
        goalObj.set('likeCount', 0);
        
        try {
          return await goalObj.save();
        } catch (error) {
          console.error('保存目标失败:', error);
          throw error;
        }
      },
      
      // 获取所有目标
      async getAllGoals() {
        const query = new AV.Query('Goals');
        query.descending('createdAt');
        
        try {
          return await query.find();
        } catch (error) {
          console.error('获取目标失败:', error);
          return [];
        }
      },
      
      // 获取点赞数最高的目标
      async getTopLikedGoals(count = 3) {
        const query = new AV.Query('Goals');
        query.greaterThan('likeCount', 0); // 只获取有点赞的目标
        query.descending('likeCount'); // 按点赞数降序排列
        query.limit(count); // 限制返回数量
        
        try {
          return await query.find();
        } catch (error) {
          console.error('获取热门目标失败:', error);
          return [];
        }
      },
      
      // 随机获取3个目标
      async getRandomGoals(count = 3) {
        const allGoals = await this.getAllGoals();
        
        if (allGoals.length <= count) {
          return allGoals;
        }
        
        // 随机排序并取前count个
        return [...allGoals]
          .sort(() => Math.random() - 0.5)
          .slice(0, count);
      },
      
      // 检查用户是否已经点赞
      async hasUserLiked(goalId, userId) {
        const query = new AV.Query('Likes');
        query.equalTo('goalId', goalId);
        query.equalTo('userId', userId);
        
        try {
          const likes = await query.find();
          return likes.length > 0;
        } catch (error) {
          console.error('检查点赞状态失败:', error);
          return false;
        }
      },
      
      // 点赞目标
      async likeGoal(goalId) {
        const userId = getUserId();
        
        // 先检查是否已经点赞
        const hasLiked = await this.hasUserLiked(goalId, userId);
        if (hasLiked) {
          throw new Error('你已经点过赞了');
        }
        
        // 创建点赞记录
        const Likes = AV.Object.extend('Likes');
        const like = new Likes();
        like.set('goalId', goalId);
        like.set('userId', userId);
        
        try {
          await like.save();
          
          // 更新目标的点赞数
          const goal = AV.Object.createWithoutData('Goals', goalId);
          goal.increment('likeCount', 1);
          await goal.save();
          
          // 点赞后重新渲染热门目标
          renderTopGoals();
          
          return true;
        } catch (error) {
          console.error('点赞失败:', error);
          throw error;
        }
      },
      
      // 获取目标的点赞数
      async getLikeCount(goalId) {
        const query = new AV.Query('Goals');
        try {
          const goal = await query.get(goalId);
          return goal.get('likeCount') || 0;
        } catch (error) {
          console.error('获取点赞数失败:', error);
          return 0;
        }
      }
    };
    
    // 显示提示框
    function showToast(message, isSuccess = true) {
      const toast = document.getElementById('toast');
      const icon = document.getElementById('toast-icon');
      const messageEl = document.getElementById('toast-message');
      
      messageEl.textContent = message;
      toast.className = `fixed bottom-6 right-6 px-6 py-3 rounded-lg shadow-lg transform translate-y-20 opacity-0 transition-all duration-500 flex items-center gap-3 ${isSuccess ? 'bg-secondary text-white' : 'bg-red-500 text-white'}`;
      icon.className = `fa ${isSuccess ? 'fa-check-circle' : 'fa-exclamation-circle'} text-xl`;
      
      // 显示提示
      setTimeout(() => {
        toast.classList.remove('translate-y-20', 'opacity-0');
      }, 100);
      
      // 3秒后隐藏
      setTimeout(() => {
        toast.classList.add('translate-y-20', 'opacity-0');
      }, 3000);
    }
    
    // 渲染随机目标卡片
    async function renderRandomGoals() {
      const container = document.getElementById('random-goals-container');
      
      try {
        const randomGoals = await GoalService.getRandomGoals();
        
        // 清空容器
        container.innerHTML = '';
        
        if (randomGoals.length === 0) {
          // 如果没有目标，显示提示
          for (let i = 0; i < 3; i++) {
            container.innerHTML += `
              <div class="flex items-center justify-center h-80 bg-gray-100 rounded-xl border-2 border-dashed border-gray-300">
                <p class="text-gray-500 text-center px-4">还没有目标，快来提交第一个吧！</p>
              </div>
            `;
          }
          return;
        }
        
        // 填充目标卡片
        for (const goal of randomGoals) {
          const goalId = goal.id;
          const userId = getUserId();
          const hasLiked = await GoalService.hasUserLiked(goalId, userId);
          const likeCount = goal.get('likeCount') || 0;
          
          const card = document.createElement('div');
          card.className = 'bg-white rounded-xl shadow-md overflow-hidden card-hover border border-gray-100 flex flex-col h-80';
          card.innerHTML = `
            <div class="p-6 flex-grow">
              <div class="flex items-center gap-2 mb-4 text-primary">
                <i class="fa fa-flag"></i>
                <span class="font-medium">目标</span>
              </div>
              <h3 class="font-bold text-lg mb-3">${goal.get('content')}</h3>
              
              <div class="space-y-2 text-gray-600 text-sm">
                <div class="flex items-start gap-2">
                  <i class="fa fa-calendar-o mt-1 text-gray-400"></i>
                  <span>完成时间：${goal.get('deadline')}</span>
                </div>
                <div class="flex items-start gap-2">
                  <i class="fa fa-check-square-o mt-1 text-gray-400"></i>
                  <span>衡量标准：${goal.get('measure')}</span>
                </div>
              </div>
            </div>
            
            <div class="mt-auto p-4 border-t border-gray-100 flex justify-between items-center">
              <button 
                class="like-btn flex items-center gap-2 px-3 py-1 rounded-full transition-all ${hasLiked ? 'bg-red-100 text-red-500' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'}"
                data-goal-id="${goalId}"
              >
                <i class="fa ${hasLiked ? 'fa-heart' : 'fa-heart-o'}"></i>
                <span class="like-count">${likeCount}</span>
              </button>
              <div class="text-xs text-gray-500">
                <span>发布于 ${new Date(goal.createdAt).toLocaleDateString()}</span>
              </div>
            </div>
          `;
          container.appendChild(card);
        }
        
        // 补充空白卡片（如果不足3个）
        const remaining = 3 - randomGoals.length;
        for (let i = 0; i < remaining; i++) {
          const emptyCard = document.createElement('div');
          emptyCard.className = 'flex items-center justify-center h-80 bg-gray-100 rounded-xl border-2 border-dashed border-gray-300';
          emptyCard.innerHTML = `
            <p class="text-gray-500 text-center px-4">等待更多目标...</p>
          `;
          container.appendChild(emptyCard);
        }
        
        // 绑定点赞按钮事件
        bindLikeButtons();
        
      } catch (error) {
        console.error('渲染随机目标失败:', error);
        container.innerHTML = `
          <div class="col-span-3 flex items-center justify-center h-80 bg-gray-100 rounded-xl">
            <p class="text-red-500 text-center px-4">加载目标失败，请刷新页面重试</p>
          </div>
        `;
      }
    }
    
    // 渲染热门目标卡片（点赞数最高）
    async function renderTopGoals() {
      const container = document.getElementById('top-goals-container');
      
      try {
        const topGoals = await GoalService.getTopLikedGoals();
        
        // 清空容器
        container.innerHTML = '';
        
        if (topGoals.length === 0) {
          // 如果没有热门目标，显示提示
          for (let i = 0; i < 3; i++) {
            container.innerHTML += `
              <div class="flex items-center justify-center h-80 bg-gray-100 rounded-xl border-2 border-dashed border-gray-300">
                <p class="text-gray-500 text-center px-4">还没有热门目标，快来点赞支持你喜欢的目标吧！</p>
              </div>
            `;
          }
          return;
        }
        
        // 填充热门目标卡片
        for (let i = 0; i < topGoals.length; i++) {
          const goal = topGoals[i];
          const goalId = goal.id;
          const userId = getUserId();
          const hasLiked = await GoalService.hasUserLiked(goalId, userId);
          const likeCount = goal.get('likeCount') || 0;
          
          // 前三名添加特殊标记
          const ranks = ['bg-yellow-500', 'bg-gray-400', 'bg-amber-700']; // 金、银、铜
          const rankText = ['1', '2', '3'];
          
          const card = document.createElement('div');
          card.className = 'bg-white rounded-xl shadow-md overflow-hidden card-hover border border-gray-100 flex flex-col h-80 relative';
          
          // 只有前三名才显示排名徽章
          const rankBadge = i < 3 ? `
            <div class="top-badge ${ranks[i]}">${rankText[i]}</div>
          ` : '';
          
          card.innerHTML = `
            ${rankBadge}
            <div class="p-6 flex-grow">
              <div class="flex items-center gap-2 mb-4 text-accent">
                <i class="fa fa-trophy"></i>
                <span class="font-medium">热门目标</span>
              </div>
              <h3 class="font-bold text-lg mb-3">${goal.get('content')}</h3>
              
              <div class="space-y-2 text-gray-600 text-sm">
                <div class="flex items-start gap-2">
                  <i class="fa fa-calendar-o mt-1 text-gray-400"></i>
                  <span>完成时间：${goal.get('deadline')}</span>
                </div>
                <div class="flex items-start gap-2">
                  <i class="fa fa-check-square-o mt-1 text-gray-400"></i>
                  <span>衡量标准：${goal.get('measure')}</span>
                </div>
              </div>
            </div>
            
            <div class="mt-auto p-4 border-t border-gray-100 flex justify-between items-center">
              <button 
                class="like-btn flex items-center gap-2 px-3 py-1 rounded-full transition-all ${hasLiked ? 'bg-red-100 text-red-500' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'}"
                data-goal-id="${goalId}"
              >
                <i class="fa ${hasLiked ? 'fa-heart' : 'fa-heart-o'}"></i>
                <span class="like-count">${likeCount}</span>
              </button>
              <div class="text-xs text-gray-500">
                <span>发布于 ${new Date(goal.createdAt).toLocaleDateString()}</span>
              </div>
            </div>
          `;
          container.appendChild(card);
        }
        
        // 补充空白卡片（如果不足3个）
        const remaining = 3 - topGoals.length;
        for (let i = 0; i < remaining; i++) {
          const emptyCard = document.createElement('div');
          emptyCard.className = 'flex items-center justify-center h-80 bg-gray-100 rounded-xl border-2 border-dashed border-gray-300';
          emptyCard.innerHTML = `
            <p class="text-gray-500 text-center px-4">等待更多热门目标...</p>
          `;
          container.appendChild(emptyCard);
        }
        
        // 绑定点赞按钮事件
        bindLikeButtons();
        
      } catch (error) {
        console.error('渲染热门目标失败:', error);
        container.innerHTML = `
          <div class="col-span-3 flex items-center justify-center h-80 bg-gray-100 rounded-xl">
            <p class="text-red-500 text-center px-4">加载热门目标失败，请刷新页面重试</p>
          </div>
        `;
      }
    }
    
    // 绑定点赞按钮事件
    function bindLikeButtons() {
      document.querySelectorAll('.like-btn').forEach(btn => {
        // 先移除已有的事件监听，避免重复绑定
        btn.removeEventListener('click', handleLike);
        btn.addEventListener('click', handleLike);
      });
    }
    
    // 处理点赞事件
    async function handleLike() {
      const goalId = this.getAttribute('data-goal-id');
      const likeIcon = this.querySelector('i');
      const likeCountEl = this.querySelector('.like-count');
      
      try {
        await GoalService.likeGoal(goalId);
        
        // 更新UI
        this.className = 'flex items-center gap-2 px-3 py-1 rounded-full transition-all bg-red-100 text-red-500';
        likeIcon.className = 'fa fa-heart like-animation';
        likeCountEl.textContent = parseInt(likeCountEl.textContent) + 1;
        
        showToast('点赞成功！');
      } catch (error) {
        showToast(error.message || '点赞失败', false);
      }
    }
    
    // 页面加载完成后初始化
    document.addEventListener('DOMContentLoaded', () => {
      // 渲染随机目标和热门目标
      renderRandomGoals();
      renderTopGoals();
      
      // 表单提交处理
      const form = document.getElementById('goal-form');
      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        // 获取表单数据
        const goal = {
          goal: document.getElementById('goal').value,
          deadline: document.getElementById('deadline').value,
          measure: document.getElementById('measure').value
        };
        
        try {
          // 保存目标
          await GoalService.saveGoal(goal);
          
          // 重置表单
          form.reset();
          
          // 重新渲染随机目标
          renderRandomGoals();
          
          // 显示成功提示
          showToast('目标提交成功！');
        } catch (error) {
          showToast('提交失败，请重试', false);
        }
      });
      
      // 刷新按钮点击事件
      document.getElementById('refresh-btn').addEventListener('click', () => {
        // 添加旋转动画
        const btn = document.getElementById('refresh-btn');
        const icon = btn.querySelector('i');
        icon.classList.add('animate-spin');
        
        // 重新渲染随机目标
        renderRandomGoals().then(() => {
          icon.classList.remove('animate-spin');
        });
      });
      
      // 平滑滚动
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
          e.preventDefault();
          document.querySelector(this.getAttribute('href')).scrollIntoView({
            behavior: 'smooth'
          });
        });
      });
    });
  </script>
</body>
</html>
