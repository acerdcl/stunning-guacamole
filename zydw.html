<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>职业定位测试 | 发现你的职业锚</title>
    <!-- 外部资源 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    
    <!-- Tailwind 配置 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6', // 主色调：蓝色（代表专业、信任）
                        secondary: '#10B981', // 辅助色：绿色（代表成长、进步）
                        accent: '#8B5CF6', // 强调色：紫色（代表创造力）
                        neutral: {
                            100: '#F3F4F6',
                            200: '#E5E7EB',
                            300: '#D1D5DB',
                            400: '#9CA3AF',
                            500: '#6B7280',
                            600: '#4B5563',
                            700: '#374151',
                            800: '#1F2937',
                            900: '#111827'
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-out forwards',
                        'slide-up': 'slideUp 0.5s ease-out forwards',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        }
                    }
                }
            }
        }
    </script>
    
    <!-- 自定义工具类 -->
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .card-hover {
                @apply transition-all duration-300 hover:shadow-lg hover:-translate-y-1;
            }
            .btn-primary {
                @apply bg-primary text-white font-medium py-2 px-6 rounded-lg transition-all duration-300 hover:bg-primary/90 focus:ring-2 focus:ring-primary/50 focus:outline-none;
            }
            .btn-secondary {
                @apply bg-white text-primary border border-primary font-medium py-2 px-6 rounded-lg transition-all duration-300 hover:bg-primary/5 focus:ring-2 focus:ring-primary/50 focus:outline-none;
            }
        }
    </style>
</head>
<body class="bg-gray-50 text-neutral-800 font-sans">
    <!-- 页面头部 -->
    <header class="bg-white shadow-sm sticky top-0 z-50 transition-all duration-300" id="header">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center">
                <i class="fa fa-compass text-primary text-2xl mr-3"></i>
                <h1 class="text-xl font-bold text-neutral-800">职业定位测试</h1>
            </div>
            <div class="hidden md:flex items-center space-x-4">
                <span class="text-sm text-neutral-500" id="progress-text">进度: 0/40题</span>
                <div class="w-40 bg-neutral-200 rounded-full h-2">
                    <div class="bg-primary h-2 rounded-full transition-all duration-500" id="progress-bar" style="width: 0%"></div>
                </div>
            </div>
        </div>
    </header>

    <!-- 主要内容区 -->
    <main class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- 开始页面 -->
        <section id="intro-section" class="py-8 animate-fade-in">
            <div class="bg-white rounded-2xl shadow-md p-8 mb-8">
                <div class="text-center mb-6">
                    <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-primary/10 text-primary mb-4">
                        <i class="fa fa-lightbulb-o text-3xl"></i>
                    </div>
                    <h2 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold text-neutral-800 mb-3">发现你的职业锚</h2>
                    <p class="text-neutral-600 max-w-2xl mx-auto">这个测试将帮助你识别自己的职业定位倾向，了解最适合你的职业发展方向。</p>
                </div>
                
                <div class="space-y-4 mb-8">
                    <div class="flex items-start">
                        <div class="flex-shrink-0 w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center mt-0.5 mr-3">
                            <i class="fa fa-check text-primary text-sm"></i>
                        </div>
                        <p class="text-neutral-600">共40道题，预计完成时间10分钟，请根据真实想法作答</p>
                    </div>
                    <div class="flex items-start">
                        <div class="flex-shrink-0 w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center mt-0.5 mr-3">
                            <i class="fa fa-check text-primary text-sm"></i>
                        </div>
                        <p class="text-neutral-600">每题从1-6分选择，1=完全不符合，6=完全符合你的想法</p>
                    </div>
                    <div class="flex items-start">
                        <div class="flex-shrink-0 w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center mt-0.5 mr-3">
                            <i class="fa fa-check text-primary text-sm"></i>
                        </div>
                        <p class="text-neutral-600">完成后将自动计算得分并生成你的职业定位分析报告</p>
                    </div>
                </div>
                
                <div class="text-center">
                    <button id="start-btn" class="btn-primary text-lg">
                        开始测试 <i class="fa fa-arrow-right ml-2"></i>
                    </button>
                </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="bg-white rounded-xl shadow-sm p-5 card-hover">
                    <div class="flex items-center mb-3">
                        <i class="fa fa-map-signs text-primary text-xl mr-3"></i>
                        <h3 class="font-bold">什么是职业锚？</h3>
                    </div>
                    <p class="text-sm text-neutral-600">职业锚是指当一个人不得不做出选择时，他/她无论如何都不会放弃的职业中至关重要的东西或价值观，是内心深处对职业的定位。</p>
                </div>
                <div class="bg-white rounded-xl shadow-sm p-5 card-hover">
                    <div class="flex items-center mb-3">
                        <i class="fa fa-question-circle text-primary text-xl mr-3"></i>
                        <h3 class="font-bold">测试结果有什么用？</h3>
                    </div>
                    <p class="text-sm text-neutral-600">帮助你了解自己的职业倾向，为专业选择、实习方向和未来职业规划提供参考，更好地规划学习和实践方向。</p>
                </div>
            </div>
        </section>

        <!-- 测试题目区域 -->
        <section id="questions-section" class="hidden">
            <div class="bg-white rounded-2xl shadow-md p-6 mb-6">
                <div class="flex justify-between items-center mb-6">
                    <div class="flex items-center">
                        <span class="bg-primary/10 text-primary px-3 py-1 rounded-full text-sm font-medium">
                            第 <span id="current-question">1</span>/40 题
                        </span>
                    </div>
                    <div class="md:hidden">
                        <span class="text-sm text-neutral-500" id="mobile-progress-text">0%</span>
                    </div>
                </div>
                
                <div class="mb-8">
                    <h3 class="text-xl font-bold mb-6" id="question-text">我希望做我擅长的工作，这样我的专业建议可以不断被采纳。</h3>
                    
                    <div class="space-y-3" id="options-container">
                        <label class="flex items-center p-3 border border-neutral-200 rounded-lg cursor-pointer hover:bg-neutral-50 transition-all">
                            <input type="radio" name="question" value="1" class="w-5 h-5 text-primary focus:ring-primary">
                            <span class="ml-3">1 - 完全不符合我的想法</span>
                        </label>
                        <label class="flex items-center p-3 border border-neutral-200 rounded-lg cursor-pointer hover:bg-neutral-50 transition-all">
                            <input type="radio" name="question" value="2" class="w-5 h-5 text-primary focus:ring-primary">
                            <span class="ml-3">2 - 偶尔这么想</span>
                        </label>
                        <label class="flex items-center p-3 border border-neutral-200 rounded-lg cursor-pointer hover:bg-neutral-50 transition-all">
                            <input type="radio" name="question" value="3" class="w-5 h-5 text-primary focus:ring-primary">
                            <span class="ml-3">3 - 有时这么想</span>
                        </label>
                        <label class="flex items-center p-3 border border-neutral-200 rounded-lg cursor-pointer hover:bg-neutral-50 transition-all">
                            <input type="radio" name="question" value="4" class="w-5 h-5 text-primary focus:ring-primary">
                            <span class="ml-3">4 - 经常这么想</span>
                        </label>
                        <label class="flex items-center p-3 border border-neutral-200 rounded-lg cursor-pointer hover:bg-neutral-50 transition-all">
                            <input type="radio" name="question" value="5" class="w-5 h-5 text-primary focus:ring-primary">
                            <span class="ml-3">5 - 频繁这么想</span>
                        </label>
                        <label class="flex items-center p-3 border border-neutral-200 rounded-lg cursor-pointer hover:bg-neutral-50 transition-all">
                            <input type="radio" name="question" value="6" class="w-5 h-5 text-primary focus:ring-primary">
                            <span class="ml-3">6 - 完全符合我的想法</span>
                        </label>
                    </div>
                </div>
                
                <div class="flex justify-between">
                    <button id="prev-btn" class="btn-secondary" disabled>
                        <i class="fa fa-arrow-left mr-2"></i> 上一题
                    </button>
                    <button id="next-btn" class="btn-primary">
                        下一题 <i class="fa fa-arrow-right ml-2"></i>
                    </button>
                </div>
            </div>
            
            <!-- 快速导航 -->
            <div class="bg-white rounded-xl shadow-sm p-4 mb-6">
                <h4 class="text-sm font-medium text-neutral-500 mb-3">题目导航</h4>
                <div class="flex flex-wrap gap-2" id="questions-nav">
                    <!-- 动态生成题目导航点 -->
                </div>
            </div>
        </section>

        <!-- 额外加分题 -->
        <section id="bonus-section" class="hidden">
            <div class="bg-white rounded-2xl shadow-md p-8">
                <div class="text-center mb-8">
                    <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-accent/10 text-accent mb-4">
                        <i class="fa fa-star text-3xl"></i>
                    </div>
                    <h2 class="text-2xl font-bold text-neutral-800 mb-3">最后一步</h2>
                    <p class="text-neutral-600 max-w-2xl mx-auto">请从已回答的40道题中，选择<strong>3道最符合你日常想法的题目</strong></p>
                </div>
                
                <div class="mb-8" id="bonus-questions-container">
                    <!-- 动态生成可选择的题目 -->
                </div>
                
                <div class="text-center">
                    <button id="calculate-btn" class="btn-primary text-lg" disabled>
                        计算结果 <i class="fa fa-calculator ml-2"></i>
                    </button>
                </div>
            </div>
        </section>

        <!-- 结果展示区域 -->
        <section id="results-section" class="hidden">
            <div class="bg-white rounded-2xl shadow-md p-8 mb-8">
                <div class="text-center mb-8">
                    <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-secondary/10 text-secondary mb-4">
                        <i class="fa fa-trophy text-3xl"></i>
                    </div>
                    <h2 class="text-2xl font-bold text-neutral-800 mb-3">你的职业定位分析</h2>
                    <p class="text-neutral-600 max-w-2xl mx-auto">基于你的回答，以下是最符合你的职业倾向分析</p>
                </div>
                
                <!-- 主要职业锚 -->
                <div class="mb-10" id="primary-anchor">
                    <div class="bg-secondary/10 border-l-4 border-secondary p-4 rounded-r-lg mb-6">
                        <h3 class="text-xl font-bold text-neutral-800 mb-1">你的主导职业锚: <span id="primary-anchor-name" class="text-secondary">技术职能型</span></h3>
                        <p class="text-neutral-600">这是最能反映你职业核心价值观的定位方向</p>
                    </div>
                    
                    <div class="bg-white border border-neutral-200 rounded-xl p-6">
                        <h4 class="font-bold text-lg mb-3 flex items-center">
                            <i class="fa fa-info-circle text-secondary mr-2"></i> 职业特点
                        </h4>
                        <p class="text-neutral-600 mb-4" id="primary-anchor-desc">
                            追求专业领域的深度发展，渴望成为某一领域的技术/专业专家。重视专业技能的提升和应用，从解决专业问题中获得成就感。
                        </p>
                        
                        <h4 class="font-bold text-lg mb-3 flex items-center">
                            <i class="fa fa-lightbulb-o text-secondary mr-2"></i> 适合的职业方向
                        </h4>
                        <ul class="text-neutral-600 list-disc pl-5 space-y-1" id="primary-anchor-careers">
                            <li>各类专业技术岗位（如软件工程师、数据分析师）</li>
                            <li>学术研究与教育领域</li>
                            <li>需要深厚专业知识的咨询岗位</li>
                            <li>医疗、法律等专业服务领域</li>
                        </ul>
                    </div>
                </div>
                
                <!-- 得分图表 -->
                <div class="mb-10">
                    <h3 class="text-xl font-bold text-neutral-800 mb-4">各类型得分情况</h3>
                    <div class="space-y-4" id="scores-container">
                        <!-- 动态生成得分条 -->
                    </div>
                </div>
                
                <!-- 其他职业锚简要说明 -->
                <div>
                    <h3 class="text-xl font-bold text-neutral-800 mb-4">其他职业锚解释</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="other-anchors">
                        <!-- 动态生成其他职业锚说明 -->
                    </div>
                </div>
            </div>
            
            <div class="text-center">
                <button id="restart-btn" class="btn-primary">
                    <i class="fa fa-refresh mr-2"></i> 重新测试
                </button>
            </div>
        </section>
    </main>

    <!-- 页脚 -->
    <footer class="bg-neutral-800 text-white/70 py-8 mt-16">
        <div class="container mx-auto px-4 text-center">
            <p class="mb-2">职业定位测试 &copy; 2024</p>
            <p class="text-sm text-white/50">注：本测试结果仅供参考，职业选择还需结合个人实际情况综合考虑</p>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // 职业定位测试题目数据
        const questions = [
            // 技术职能型
            { id: 1, text: "我希望做我擅长的工作，这样我的专业建议可以不断被采纳。", type: "技术职能型" },
            { id: 9, text: "将我的技术和专业水平发展到一个更具有竞争力的层次是职业成功的必要条件。", type: "技术职能型" },
            { id: 17, text: "对我而言，在我喜欢的专业领域内做资深专家比做总经理更具有吸引力。", type: "技术职能型" },
            { id: 25, text: "我宁愿离开公司，也不愿频繁接受那些不属于我专业领域的工作。", type: "技术职能型" },
            { id: 33, text: "如果在工作中能经常用到我特别的技巧和才能，我会感到特别满意。", type: "技术职能型" },
            
            // 管理型
            { id: 2, text: "当我整合并管理其他人的工作时，我非常有成就感。", type: "管理型" },
            { id: 10, text: "我希望能够管理一个大的公司（组织），我的决策将会影响许多人。", type: "管理型" },
            { id: 18, text: "只有在我成为公司的总经理后，我才认为我的职业人生是成功的。", type: "管理型" },
            { id: 26, text: "对我而言，做一个全面管理者比在我喜欢的专业领域内做资深专家更有吸引力。", type: "管理型" },
            { id: 34, text: "我宁愿离开公司，也不愿意接受让我离开全面管理的工作。", type: "管理型" },
            
            // 自主独立型
            { id: 3, text: "我希望我的工作能让我用自己的方式，按自己的计划去开展。", type: "自主独立型" },
            { id: 11, text: "如果职业允许自由地决定自己的工作内容、计划、过程时，我会非常满意。", type: "自主独立型" },
            { id: 19, text: "成功的职业应该允许我有完全的自主与自由。", type: "自主独立型" },
            { id: 27, text: "对我而言，用我自己的方式不受约束地完成工作，比安全、稳定更加重要。", type: "自主独立型" },
            { id: 35, text: "我宁愿离开公司，也不愿意接受约束我自由和自主控制权的工作。", type: "自主独立型" },
            
            // 安全稳定型
            { id: 4, text: "对我而言，安定与稳定比自由和自主更重要。", type: "安全稳定型" },
            { id: 12, text: "如果工作的结果使我丧失了自己在组织中的安全稳定感，我宁愿离开这个工作岗位。", type: "安全稳定型" },
            { id: 20, text: "我愿意在能给我安全感、稳定感的公司中工作。", type: "安全稳定型" },
            { id: 28, text: "只有当我的收入和工作有保障时，我才会对工作感到满意。", type: "安全稳定型" },
            { id: 36, text: "我希望有一份让我有安全感和稳定感的工作。", type: "安全稳定型" },
            
            // 创造型
            { id: 5, text: "我一直在寻找可以让我创立自己事业（公司）的创意（点子）。", type: "创造型" },
            { id: 13, text: "对我而言，创办自己的公司比在其他的公司中争取一个高的管理位置更有意义。", type: "创造型" },
            { id: 21, text: "当通过自己的努力或想法完成工作时，我的工作成就感最强。", type: "创造型" },
            { id: 29, text: "在我的职业生涯中，如果我能成功地创造或实现完全属于自己的产品或点子，我会感到非常成功。", type: "创造型" },
            { id: 37, text: "我梦想着创建属于自己的事业。", type: "创造型" },
            
            // 服务奉献型
            { id: 6, text: "我认为只有对社会作出真正贡献的职业才算是成功的职业。", type: "服务奉献型" },
            { id: 14, text: "我的职业满足感来自我可以用自己的才能去为他人提供服务。", type: "服务奉献型" },
            { id: 22, text: "对我而言，利用自己的才能使这个世界变得更适合生活或居住，比争取一个高的管理职位更重要。", type: "服务奉献型" },
            { id: 30, text: "我希望从事对人类和社会真正有贡献的工作。", type: "服务奉献型" },
            { id: 38, text: "如果工作限制了我为他人提供帮助或服务，我宁愿离开公司。", type: "服务奉献型" },
            
            // 挑战型
            { id: 7, text: "在工作中，我希望去解决那些有挑战性的问题，并且胜出。", type: "挑战型" },
            { id: 15, text: "我认为职业的成就感来自克服自己面临的非常有挑战性的困难。", type: "挑战型" },
            { id: 23, text: "当我解决了看上去不可能解决的问题，或者在必输无疑的竞赛中胜出，我会非常有成就感。", type: "挑战型" },
            { id: 31, text: "我希望工作中有很多的机会，可以不断挑战我解决问题的能力（或竞争力）。", type: "挑战型" },
            { id: 39, text: "去解决那些几乎无法解决的难题，比获得一个高的管理职位更有意义。", type: "挑战型" },
            
            // 生活型
            { id: 8, text: "我宁愿离开公司，也不愿从事需要个人和家庭做出一定牺牲的工作。", type: "生活型" },
            { id: 16, text: "我希望我的职业能够兼顾个人、家庭和工作的需要。", type: "生活型" },
            { id: 24, text: "我认为只有很好地平衡个人、家庭、职业三者的关系，生活才能算是成功的。", type: "生活型" },
            { id: 32, text: "对我而言，能很好地平衡个人生活与工作，比达到一个高的管理职位更重要。", type: "生活型" },
            { id: 40, text: "我一直在寻找一份能最小化个人和家庭之间冲突的工作。", type: "生活型" }
        ];

        // 职业锚类型说明
        const anchorTypes = {
            "技术职能型": {
                desc: "追求专业领域的深度发展，渴望成为某一领域的技术/专业专家。重视专业技能的提升和应用，从解决专业问题中获得成就感。",
                careers: [
                    "各类专业技术岗位（如软件工程师、数据分析师）",
                    "学术研究与教育领域",
                    "需要深厚专业知识的咨询岗位",
                    "医疗、法律等专业服务领域"
                ]
            },
            "管理型": {
                desc: "向往管理岗位，享受统筹团队、制定决策、影响他人的过程。具有较强的组织能力、决策能力和人际协调能力，追求通过管理实现组织目标。",
                careers: [
                    "企业中高层管理岗位",
                    "项目管理与团队领导岗位",
                    "创业公司创始人/合伙人",
                    "公共事业管理领域"
                ]
            },
            "自主独立型": {
                desc: "重视工作中的自由与自主权，希望按自己的节奏和方式推进事务。不喜欢被过多约束和控制，追求工作中的独立决策和灵活安排。",
                careers: [
                    "自由职业者（如设计师、作家、顾问）",
                    "独立创业者",
                    "远程工作岗位",
                    "科研人员（独立项目）"
                ]
            },
            "安全稳定型": {
                desc: "优先考虑工作的稳定性、安全感，追求可预期的职业路径。重视福利保障、工作环境和长期发展的确定性，倾向于选择大型企业或体制内工作。",
                careers: [
                    "政府机关及事业单位",
                    "大型国有企业",
                    "金融、能源等传统行业核心岗位",
                    "有完善保障体系的跨国公司"
                ]
            },
            "创造型": {
                desc: "渴望创新与创业，希望通过创意或点子打造属于自己的事业/产品。具有强烈的创新意识和企业家精神，享受从无到有创造价值的过程。",
                careers: [
                    "创业公司创始人",
                    "产品经理与创新岗位",
                    "艺术创作与设计领域",
                    "研发与创新部门"
                ]
            },
            "服务奉献型": {
                desc: "重视职业对他人或社会的贡献，从帮助他人、改善社会中获得满足。具有强烈的社会责任感和利他精神，关注工作的社会价值。",
                careers: [
                    "教育与培训行业",
                    "医疗健康领域",
                    "公益组织与社会工作",
                    "公共服务与社区工作"
                ]
            },
            "挑战型": {
                desc: "享受攻克难题、突破极限的过程，追求充满挑战性的工作内容。在解决复杂问题和克服困难中获得成就感，喜欢不断挑战自我能力边界。",
                careers: [
                    "咨询顾问（解决复杂问题）",
                    "投资与风险评估",
                    "竞技体育与极限行业",
                    "科研攻坚与技术突破岗位"
                ]
            },
            "生活型": {
                desc: "希望平衡工作与个人/家庭生活，优先保障生活质量而非职业成就。重视工作与生活的和谐，追求稳定的生活节奏和个人时间的保障。",
                careers: [
                    "弹性工作制岗位",
                    "工作生活平衡较好的企业",
                    "兼职与自由职业组合",
                    "小型企业或社区服务岗位"
                ]
            }
        };

        // 全局变量
        let currentQuestionIndex = 0;
        const answers = {}; // 存储答案
        const selectedBonusQuestions = []; // 存储选中的加分题

        // DOM元素
        const introSection = document.getElementById('intro-section');
        const questionsSection = document.getElementById('questions-section');
        const bonusSection = document.getElementById('bonus-section');
        const resultsSection = document.getElementById('results-section');
        
        const startBtn = document.getElementById('start-btn');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const calculateBtn = document.getElementById('calculate-btn');
        const restartBtn = document.getElementById('restart-btn');
        
        const currentQuestionEl = document.getElementById('current-question');
        const questionTextEl = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const questionsNav = document.getElementById('questions-nav');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');
        const mobileProgressText = document.getElementById('mobile-progress-text');
        const bonusQuestionsContainer = document.getElementById('bonus-questions-container');
        
        const header = document.getElementById('header');

        // 初始化题目导航
        function initQuestionsNav() {
            questionsNav.innerHTML = '';
            questions.forEach((q, index) => {
                const navItem = document.createElement('button');
                navItem.className = 'w-8 h-8 rounded-full bg-neutral-100 flex items-center justify-center text-sm text-neutral-600 hover:bg-primary/10 hover:text-primary transition-all';
                navItem.textContent = q.id;
                navItem.addEventListener('click', () => {
                    if (Object.keys(answers).length > 0) {
                        goToQuestion(index);
                    }
                });
                navItem.dataset.index = index;
                questionsNav.appendChild(navItem);
            });
        }

        // 更新题目显示
        function updateQuestionDisplay() {
            const question = questions[currentQuestionIndex];
            currentQuestionEl.textContent = question.id;
            questionTextEl.textContent = question.text;
            
            // 清除之前的选中状态
            document.querySelectorAll('input[name="question"]').forEach(radio => {
                radio.checked = false;
            });
            
            // 设置已有的答案
            if (answers[question.id]) {
                const radio = document.querySelector(`input[name="question"][value="${answers[question.id]}"]`);
                if (radio) radio.checked = true;
            }
            
            // 更新导航状态
            updateNavStatus();
            
            // 更新按钮状态
            prevBtn.disabled = currentQuestionIndex === 0;
            nextBtn.textContent = currentQuestionIndex === questions.length - 1 ? 
                '完成题目 <i class="fa fa-check ml-2"></i>' : 
                '下一题 <i class="fa fa-arrow-right ml-2"></i>';
            nextBtn.innerHTML = currentQuestionIndex === questions.length - 1 ? 
                '完成题目 <i class="fa fa-check ml-2"></i>' : 
                '下一题 <i class="fa fa-arrow-right ml-2"></i>';
                
            // 更新进度
            const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
            progressBar.style.width = `${progress}%`;
            progressText.textContent = `进度: ${currentQuestionIndex + 1}/${questions.length}题`;
            mobileProgressText.textContent = `${Math.round(progress)}%`;
            
            // 滚动到顶部
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // 更新导航状态
        function updateNavStatus() {
            document.querySelectorAll('#questions-nav button').forEach((btn, index) => {
                const questionId = questions[index].id;
                if (index === currentQuestionIndex) {
                    btn.className = 'w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center text-sm transition-all';
                } else if (answers[questionId]) {
                    btn.className = 'w-8 h-8 rounded-full bg-secondary/20 text-secondary flex items-center justify-center text-sm transition-all';
                } else {
                    btn.className = 'w-8 h-8 rounded-full bg-neutral-100 flex items-center justify-center text-sm text-neutral-600 hover:bg-primary/10 hover:text-primary transition-all';
                }
            });
        }

        // 前往指定题目
        function goToQuestion(index) {
            if (index >= 0 && index < questions.length) {
                currentQuestionIndex = index;
                updateQuestionDisplay();
            }
        }

        // 保存当前答案
        function saveCurrentAnswer() {
            const selectedOption = document.querySelector('input[name="question"]:checked');
            if (selectedOption) {
                const questionId = questions[currentQuestionIndex].id;
                answers[questionId] = parseInt(selectedOption.value);
                return true;
            }
            return false;
        }

        // 生成加分题选择
        function generateBonusQuestions() {
            bonusQuestionsContainer.innerHTML = '';
            
            // 随机选择10道题供用户选择（但用户可能已经回答了所有题）
            const shuffledQuestions = [...questions].sort(() => 0.5 - Math.random()).slice(0, 10);
            
            shuffledQuestions.forEach(question => {
                const questionEl = document.createElement('div');
                questionEl.className = 'flex items-start p-4 border border-neutral-200 rounded-lg mb-3 cursor-pointer hover:bg-neutral-50 transition-all';
                questionEl.innerHTML = `
                    <input type="checkbox" value="${question.id}" class="w-5 h-5 text-accent mt-1 focus:ring-accent">
                    <span class="ml-3 text-neutral-700">Q${question.id}: ${question.text}</span>
                `;
                
                const checkbox = questionEl.querySelector('input');
                checkbox.addEventListener('change', (e) => {
                    if (e.target.checked) {
                        if (selectedBonusQuestions.length < 3) {
                            selectedBonusQuestions.push(question.id);
                        } else {
                            e.target.checked = false;
                            alert('最多只能选择3道题');
                        }
                    } else {
                        const index = selectedBonusQuestions.indexOf(question.id);
                        if (index > -1) {
                            selectedBonusQuestions.splice(index, 1);
                        }
                    }
                    
                    // 更新计算按钮状态
                    calculateBtn.disabled = selectedBonusQuestions.length !== 3;
                });
                
                bonusQuestionsContainer.appendChild(questionEl);
            });
        }

        // 计算结果
        function calculateResults() {
            // 初始化各类型分数
            const scores = {
                "技术职能型": 0,
                "管理型": 0,
                "自主独立型": 0,
                "安全稳定型": 0,
                "创造型": 0,
                "服务奉献型": 0,
                "挑战型": 0,
                "生活型": 0
            };
            
            // 统计各类型基础分
            questions.forEach(question => {
                if (answers[question.id]) {
                    scores[question.type] += answers[question.id];
                }
            });
            
            // 加上额外分数（每题加4分）
            selectedBonusQuestions.forEach(questionId => {
                const question = questions.find(q => q.id === questionId);
                if (question) {
                    scores[question.type] += 4;
                }
            });
            
            // 计算平均分（每种类型5题）
            const averages = {};
            Object.keys(scores).forEach(type => {
                averages[type] = (scores[type] / 5).toFixed(1);
            });
            
            // 找出最高分的类型
            let maxScore = 0;
            let primaryType = "";
            Object.keys(averages).forEach(type => {
                if (parseFloat(averages[type]) > maxScore) {
                    maxScore = parseFloat(averages[type]);
                    primaryType = type;
                }
            });
            
            // 显示结果
            displayResults(averages, primaryType);
        }

        // 显示结果
        function displayResults(averages, primaryType) {
            // 更新主要职业锚
            document.getElementById('primary-anchor-name').textContent = primaryType;
            document.getElementById('primary-anchor-desc').textContent = anchorTypes[primaryType].desc;
            
            // 更新适合的职业方向
            const careersList = document.getElementById('primary-anchor-careers');
            careersList.innerHTML = '';
            anchorTypes[primaryType].careers.forEach(career => {
                const li = document.createElement('li');
                li.textContent = career;
                careersList.appendChild(li);
            });
            
            // 显示各类型得分
            const scoresContainer = document.getElementById('scores-container');
            scoresContainer.innerHTML = '';
            
            // 按分数排序
            const sortedTypes = Object.keys(averages).sort((a, b) => parseFloat(averages[b]) - parseFloat(averages[a]));
            
            sortedTypes.forEach(type => {
                const scoreEl = document.createElement('div');
                const percentage = (parseFloat(averages[type]) / 6) * 100; // 6分制转换为百分比
                
                // 为最高分添加特殊样式
                const isPrimary = type === primaryType;
                
                scoreEl.innerHTML = `
                    <div class="flex justify-between mb-1">
                        <span class="${isPrimary ? 'font-bold text-secondary' : ''}">${type}</span>
                        <span class="${isPrimary ? 'font-bold text-secondary' : ''}">${averages[type]}/6.0</span>
                    </div>
                    <div class="w-full bg-neutral-200 rounded-full h-2.5">
                        <div class="${isPrimary ? 'bg-secondary' : 'bg-primary'} h-2.5 rounded-full transition-all duration-1000 ease-out" style="width: 0%"></div>
                    </div>
                `;
                
                scoresContainer.appendChild(scoreEl);
                
                // 动画效果
                setTimeout(() => {
                    scoreEl.querySelector('div div div').style.width = `${percentage}%`;
                }, 100);
            });
            
            // 显示其他职业锚说明
            const otherAnchorsContainer = document.getElementById('other-anchors');
            otherAnchorsContainer.innerHTML = '';
            
            sortedTypes.slice(1).forEach(type => { // 跳过第一个，已经在主要职业锚中显示
                const anchorEl = document.createElement('div');
                anchorEl.className = 'bg-white border border-neutral-200 rounded-xl p-4';
                anchorEl.innerHTML = `
                    <h4 class="font-bold mb-2">${type}</h4>
                    <p class="text-sm text-neutral-600 line-clamp-2">${anchorTypes[type].desc}</p>
                `;
                otherAnchorsContainer.appendChild(anchorEl);
            });
            
            // 显示结果区域
            bonusSection.classList.add('hidden');
            resultsSection.classList.remove('hidden');
            resultsSection.classList.add('animate-slide-up');
            
            // 滚动到顶部
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // 重置测试
        function resetTest() {
            currentQuestionIndex = 0;
            Object.keys(answers).forEach(key => delete answers[key]);
            selectedBonusQuestions.length = 0;
            
            resultsSection.classList.add('hidden');
            introSection.classList.remove('hidden');
            introSection.classList.add('animate-fade-in');
            
            progressBar.style.width = '0%';
            progressText.textContent = '进度: 0/40题';
            mobileProgressText.textContent = '0%';
        }

        // 事件监听
        startBtn.addEventListener('click', () => {
            introSection.classList.add('hidden');
            questionsSection.classList.remove('hidden');
            questionsSection.classList.add('animate-slide-up');
            initQuestionsNav();
            updateQuestionDisplay();
        });

        prevBtn.addEventListener('click', () => {
            saveCurrentAnswer();
            goToQuestion(currentQuestionIndex - 1);
        });

        nextBtn.addEventListener('click', () => {
            // 检查是否已选择答案
            if (!saveCurrentAnswer()) {
                // 抖动效果提示用户选择答案
                optionsContainer.classList.add('animate-shake');
                setTimeout(() => {
                    optionsContainer.classList.remove('animate-shake');
                }, 500);
                return;
            }
            
            // 如果是最后一题，进入加分题环节
            if (currentQuestionIndex === questions.length - 1) {
                questionsSection.classList.add('hidden');
                bonusSection.classList.remove('hidden');
                bonusSection.classList.add('animate-slide-up');
                generateBonusQuestions();
            } else {
                goToQuestion(currentQuestionIndex + 1);
            }
        });

        calculateBtn.addEventListener('click', calculateResults);

        restartBtn.addEventListener('click', resetTest);

        // 监听滚动事件，改变头部样式
        window.addEventListener('scroll', () => {
            if (window.scrollY > 50) {
                header.classList.add('py-2', 'shadow');
                header.classList.remove('py-4');
            } else {
                header.classList.add('py-4');
                header.classList.remove('py-2', 'shadow');
            }
        });

        // 初始化页面
        window.addEventListener('load', () => {
            introSection.classList.add('animate-fade-in');
        });
    </script>
</body>
</html>
