<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>班级职业理想共创</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#8B5CF6',
                        secondary: '#ECFDF5',
                        neutral: '#F3F4F6',
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .card-shadow {
                box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.03);
            }
        }
    </style>
</head>
<body class="bg-gradient-to-b from-blue-50 to-indigo-50 min-h-screen">
    <!-- 弹幕容器 -->
    <div id="danmaku-container" class="fixed top-0 left-0 w-full h-full pointer-events-none z-50 overflow-hidden">
        <!-- 弹幕将通过JS动态添加到这里 -->
    </div>

    <div class="container mx-auto px-4 py-12 max-w-5xl">
        <!-- 标题区域 -->
        <div class="text-center mb-10">
            <h1 class="text-[clamp(2rem,5vw,3.5rem)] font-bold text-gray-800 mb-4 text-shadow">班级职业理想共创</h1>
            <p class="text-gray-600 text-lg max-w-2xl mx-auto">输入并分享你的职业理想，共同创建我们班级的职业理想词云</p>
        </div>

        <!-- 输入区域 -->
        <div class="bg-white rounded-xl p-6 mb-8 card-shadow transition-all duration-300 hover:shadow-lg">
            <div class="flex flex-col sm:flex-row gap-4 items-center">
                <input 
                    type="text" 
                    id="ideal-input" 
                    placeholder="例如: 自由、创新、稳定..." 
                    class="flex-grow px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all"
                >
                <button 
                    id="submit-btn" 
                    class="px-6 py-3 bg-primary text-white rounded-lg font-medium hover:bg-primary/90 transition-all transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-primary/50"
                >
                    提交
                </button>
            </div>
            <div class="mt-3 text-right">
                <button id="clear-btn" class="text-gray-500 text-sm hover:text-red-500 transition-colors flex items-center ml-auto">
                    <i class="fa fa-eraser mr-1"></i> 清除我的提交
                </button>
            </div>
        </div>

        <!-- 词云区域 -->
        <div class="bg-white rounded-xl p-6 card-shadow">
            <div class="flex items-center mb-4">
                <i class="fa fa-cloud text-primary text-xl mr-2"></i>
                <h2 class="text-xl font-semibold text-gray-800">班级职业理想词云</h2>
            </div>
            <div id="wordcloud-container" class="w-full h-80 bg-gray-50 rounded-lg flex items-center justify-center border border-gray-200">
                <!-- 词云生成失败状态 -->
                <p class="text-red-500 text-center">词云生成失败，请重试</p>
            </div>
        </div>
    </div>

    <script>
        // 弹幕系统实现
        class Danmaku {
            constructor(containerId) {
                this.container = document.getElementById(containerId);
                this.danmakus = [];
                this.isRunning = false;
                this.defaultTexts = [
                    "我想成为一名医生",
                    "希望未来能创业",
                    "想做一名程序员",
                    "成为一名教师",
                    "希望能环游世界",
                    "想从事设计工作",
                    "成为科学家",
                    "想进入金融行业",
                    "希望工作能帮助他人",
                    "想做自由职业者"
                ];
                
                // 初始化一些默认弹幕
                this.initDefaultDanmakus();
                
                // 开始弹幕动画
                this.start();
            }
            
            // 初始化默认弹幕
            initDefaultDanmakus() {
                this.defaultTexts.forEach((text, index) => {
                    // 错开时间显示
                    setTimeout(() => {
                        this.addDanmaku(text);
                    }, index * 1000);
                });
            }
            
            // 添加新弹幕
            addDanmaku(text) {
                if (!text.trim()) return;
                
                const danmaku = document.createElement('div');
                const size = Math.random() > 0.5 ? 'text-base' : 'text-sm';
                const color = this.getRandomColor();
                
                danmaku.className = `absolute whitespace-nowrap ${size} font-medium pointer-events-none transition-transform duration-15000 ease-linear`;
                danmaku.style.color = color;
                danmaku.textContent = text;
                
                // 随机位置
                const containerHeight = this.container.clientHeight;
                const top = Math.floor(Math.random() * (containerHeight - 40));
                danmaku.style.top = `${top}px`;
                danmaku.style.right = `-${danmaku.offsetWidth}px`;
                
                this.container.appendChild(danmaku);
                this.danmakus.push(danmaku);
                
                // 动画
                setTimeout(() => {
                    const containerWidth = this.container.clientWidth;
                    danmaku.style.transform = `translateX(-${containerWidth + danmaku.offsetWidth}px)`;
                }, 100);
                
                // 移除弹幕
                setTimeout(() => {
                    this.removeDanmaku(danmaku);
                }, 15000);
            }
            
            // 移除弹幕
            removeDanmaku(danmaku) {
                const index = this.danmakus.indexOf(danmaku);
                if (index > -1) {
                    this.danmakus.splice(index, 1);
                }
                danmaku.remove();
            }
            
            // 获取随机颜色
            getRandomColor() {
                const colors = [
                    '#3B82F6', '#10B981', '#F59E0B', '#EF4444', 
                    '#8B5CF6', '#EC4899', '#6366F1', '#14B8A6'
                ];
                return colors[Math.floor(Math.random() * colors.length)];
            }
            
            // 开始弹幕
            start() {
                if (this.isRunning) return;
                this.isRunning = true;
                
                // 定时添加随机弹幕
                this.interval = setInterval(() => {
                    const randomText = this.defaultTexts[Math.floor(Math.random() * this.defaultTexts.length)];
                    this.addDanmaku(randomText);
                }, 3000);
            }
            
            // 停止弹幕
            stop() {
                this.isRunning = false;
                clearInterval(this.interval);
                this.danmakus.forEach(d => d.remove());
                this.danmakus = [];
            }
        }

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', () => {
            // 初始化弹幕系统
            const danmaku = new Danmaku('danmaku-container');
            
            // 获取DOM元素
            const input = document.getElementById('ideal-input');
            const submitBtn = document.getElementById('submit-btn');
            const clearBtn = document.getElementById('clear-btn');
            
            // 提交按钮点击事件
            submitBtn.addEventListener('click', () => {
                const text = input.value.trim();
                if (text) {
                    // 添加到弹幕
                    danmaku.addDanmaku(text);
                    
                    // 保存到本地存储
                    let submissions = JSON.parse(localStorage.getItem('careerIdeals') || '[]');
                    submissions.push(text);
                    localStorage.setItem('careerIdeals', JSON.stringify(submissions));
                    
                    // 显示已提交状态
                    submitBtn.innerHTML = '<i class="fa fa-check mr-1"></i> 已提交';
                    submitBtn.disabled = true;
                    submitBtn.classList.add('bg-green-500', 'cursor-not-allowed');
                    
                    input.value = '';
                }
            });
            
            // 清除按钮点击事件
            clearBtn.addEventListener('click', () => {
                localStorage.removeItem('careerIdeals');
                submitBtn.innerHTML = '提交';
                submitBtn.disabled = false;
                submitBtn.classList.remove('bg-green-500', 'cursor-not-allowed');
            });
            
            // 检查是否有已提交的内容
            if (localStorage.getItem('careerIdeals')) {
                submitBtn.innerHTML = '<i class="fa fa-check mr-1"></i> 已提交';
                submitBtn.disabled = true;
                submitBtn.classList.add('bg-green-500', 'cursor-not-allowed');
            }
            
            // 回车提交
            input.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    submitBtn.click();
                }
            });
        });
    </script>
</body>
</html>
