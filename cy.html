<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>职业理想分享平台</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/wordcloud2.js@1.2.0/src/wordcloud2.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4F9EFD',
                        secondary: '#52C41A',
                        neutral: '#F5F7FA',
                        dark: '#1F2937'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .barrage-container {
                overflow: hidden;
                position: relative;
                height: 250px;
            }
            .barrage-item {
                position: absolute;
                white-space: nowrap;
                animation: barrage 8s linear forwards;
            }
            @keyframes barrage {
                from { transform: translateX(100%); }
                to { transform: translateX(-100%); }
            }
            .fade-in {
                animation: fadeIn 0.5s ease-in-out;
            }
            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-5xl">
        <header class="text-center mb-10">
            <h1 class="text-[clamp(1.8rem,5vw,2.5rem)] font-bold text-dark mb-3">职业理想分享平台</h1>
            <p class="text-gray-600 max-w-2xl mx-auto">分享你的职业理想，看看大家共同的追求是什么</p>
        </header>

        <!-- 输入区域 -->
        <div class="bg-white rounded-xl shadow-md p-6 mb-8 transition-all duration-300 hover:shadow-lg">
            <form id="idealForm" class="flex flex-col sm:flex-row gap-3">
                <input 
                    type="text" 
                    id="idealInput" 
                    placeholder="输入代表你职业理想的词（如：自由、创新）" 
                    class="flex-1 px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all"
                    required
                >
                <button 
                    type="submit" 
                    class="bg-primary hover:bg-primary/90 text-white px-6 py-3 rounded-lg transition-all flex items-center justify-center gap-2 font-medium"
                >
                    <i class="fa fa-paper-plane"></i>
                    <span>提交</span>
                </button>
            </form>
            <div id="submitMessage" class="mt-3 text-secondary hidden fade-in">
                <i class="fa fa-check-circle"></i> 你已经提交过职业理想啦！
            </div>
        </div>

        <!-- 实时弹幕区域 -->
        <div class="bg-white rounded-xl shadow-md p-6 mb-8 overflow-hidden">
            <div class="flex items-center gap-2 mb-4">
                <i class="fa fa-commenting-o text-primary text-xl"></i>
                <h2 class="text-xl font-semibold text-dark">实时弹幕</h2>
            </div>
            <div id="barrageContainer" class="barrage-container bg-neutral rounded-lg border border-gray-100">
                <!-- 弹幕将在这里动态生成 -->
            </div>
        </div>

        <!-- 词云区域 -->
        <div class="bg-white rounded-xl shadow-md p-6">
            <div class="flex items-center gap-2 mb-4">
                <i class="fa fa-cloud text-orange-500 text-xl"></i>
                <h2 class="text-xl font-semibold text-dark">班级职业理想词云</h2>
            </div>
            <div id="wordcloudContainer" class="h-80 bg-neutral rounded-lg border border-gray-100 flex items-center justify-center">
                <div id="wordcloudPlaceholder" class="text-gray-400">
                    <i class="fa fa-info-circle mr-2"></i>
                    词云将在这里显示
                </div>
                <canvas id="wordcloudCanvas" class="w-full h-full hidden"></canvas>
            </div>
        </div>
    </div>

    <script>
        // 存储所有职业理想数据
        let idealsData = [];
        // 记录用户是否已提交
        let userSubmitted = false;
        
        // DOM元素
        const idealForm = document.getElementById('idealForm');
        const idealInput = document.getElementById('idealInput');
        const submitMessage = document.getElementById('submitMessage');
        const barrageContainer = document.getElementById('barrageContainer');
        const wordcloudContainer = document.getElementById('wordcloudContainer');
        const wordcloudPlaceholder = document.getElementById('wordcloudPlaceholder');
        const wordcloudCanvas = document.getElementById('wordcloudCanvas');
        
        // 模拟已接收到的初始数据（实际应用中这会从服务器获取）
        const initialData = [
            "自由", "创新", "成长", "挑战", "贡献", 
            "高薪", "稳定", "影响力", "创造力", "领导力",
            "专业", "平衡", "激情", "价值", "成就",
            "探索", "合作", "独立", "发展", "卓越"
        ];
        
        // 初始化
        function init() {
            // 加载初始数据
            idealsData = [...initialData];
            // 生成初始弹幕
            initialData.forEach((ideal, index) => {
                // 错开时间显示，避免拥挤
                setTimeout(() => {
                    addBarrage(ideal);
                }, index * 500);
            });
            // 生成初始词云
            updateWordcloud();
        }
        
        // 表单提交处理
        idealForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const ideal = idealInput.value.trim();
            
            if (ideal && !userSubmitted) {
                // 添加到数据中
                idealsData.push(ideal);
                // 标记为已提交
                userSubmitted = true;
                // 显示提交成功消息
                submitMessage.classList.remove('hidden');
                // 清空输入框并禁用
                idealInput.value = '';
                idealInput.disabled = true;
                // 添加新弹幕
                addBarrage(ideal);
                // 更新词云
                updateWordcloud();
            }
        });
        
        // 添加弹幕
        function addBarrage(text) {
            const barrage = document.createElement('div');
            barrage.className = 'barrage-item fade-in';
            
            // 随机样式
            const colors = ['text-blue-500', 'text-green-500', 'text-purple-500', 'text-orange-500', 'text-pink-500', 'text-teal-500'];
            const randomColor = colors[Math.floor(Math.random() * colors.length)];
            const randomSize = Math.floor(Math.random() * 3) + 14; // 14-16px
            const randomTop = Math.floor(Math.random() * 80) + 10; // 10-90%
            
            barrage.classList.add(randomColor);
            barrage.style.fontSize = `${randomSize}px`;
            barrage.style.top = `${randomTop}%`;
            barrage.style.animationDuration = `${Math.floor(Math.random() * 5) + 6}s`; // 6-10秒
            barrage.textContent = text;
            
            barrageContainer.appendChild(barrage);
            
            // 动画结束后移除元素
            setTimeout(() => {
                barrage.remove();
            }, 10000);
        }
        
        // 更新词云
        function updateWordcloud() {
            // 计算词频
            const wordCounts = {};
            idealsData.forEach(word => {
                wordCounts[word] = (wordCounts[word] || 0) + 1;
            });
            
            // 转换为词云需要的格式 [[word, count], ...]
            const wordList = Object.entries(wordCounts);
            
            // 显示词云，隐藏占位符
            wordcloudPlaceholder.classList.add('hidden');
            wordcloudCanvas.classList.remove('hidden');
            
            // 生成词云
            WordCloud(wordcloudCanvas, {
                list: wordList,
                size: 16,
                color: function(word, weight) {
                    const colors = ['#3B82F6', '#10B981', '#8B5CF6', '#F97316', '#EC4899', '#06B6D4'];
                    return colors[Math.floor(Math.random() * colors.length)];
                },
                backgroundColor: 'transparent',
                fontFamily: 'Inter, sans-serif',
                rotateRatio: 0.3, // 30%的词会旋转
                minSize: 12,
                gridSize: 8
            });
        }
        
        // 定期添加随机弹幕，模拟实时效果
        setInterval(() => {
            if (idealsData.length > 0) {
                const randomIdeal = idealsData[Math.floor(Math.random() * idealsData.length)];
                addBarrage(randomIdeal);
            }
        }, 2000);
        
        // 页面加载完成后初始化
        window.addEventListener('load', init);
    </script>
</body>
</html>
